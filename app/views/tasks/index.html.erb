<% if user_signed_in?%>
  <p style="color: green"><%= notice %></p>
  
  <div id="tasks">
    <h1>Pending tasks</h1>
    <%= link_to "New task", new_task_path, data: { turbo_frame: "bruh" }, type:"button", id: "btn-add", class: "btn btn-lg btn-primary" %>
    
    <% @tasks.all.order('created_at DESC').each do |task| %>
      <% if current_user.id == task.user_id && task.completed == false%>
        <div id="<%= dom_id task %>" class="task">

        <%=button_to " ", refresh_path(:task => task), remote: true, method: :post, style: "height:20px;width:20px;border-radius:20px;" %>
        <strong>Title:</strong>
        <%= task.title %>
        <br/>
        <strong>Due:</strong>
        <%= task.due %>
        <p>
          <%= link_to "Show this task", task, class: 'link' %>
        </p>
        <div class="box">
          <a class="button" href="#popup2">ShowTask</a>
        </div>
      </div>
      <%end%>  
    <% end %>
      <div id = "new-tasks"></div>
  </div>


    <details id="completed-tasks">
      <summary>Completed tasks</summary>
      
        <% @tasks.all.order('completed_time DESC').reject{|task| task.completed_time.nil?}.each do |task| %>
          <% if current_user.id == task.user_id && task.completed == true%>
            <div id="<%= dom_id task %>" class="task">
            <%=button_to " ", uncomplete_path(:task => task), style: "height:20px;width:20px;border-radius:20px;" %>
            <strong>Title:</strong>
            <%= task.title %>
            <br/>
            <strong>Completed:</strong>
            <%= task.completed %>
            <p>
              <%= link_to "Show this task", task, class: 'link' %>
            </p>
          </div>

        <%end%>  
        <% end %>
    
    <div id = "new-completed-tasks"></div>
    </details>
<%end%>

